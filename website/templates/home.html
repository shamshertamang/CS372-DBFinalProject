<!-- home.html -->

{% extends "base.html" %}
{% block title %}Home{% endblock %}

{% block profile %}
  {% if user.is_authenticated %}
  <a class="nav-item nav-link" id="profile" href="{{ url_for('views.profile_page') }}">Profile</a>
  {% endif %}
{% endblock %}


{% block content %}

<h1 align="center" id = "Recipees">Recipes</h1>

<!-- Links to Meals and Meal Plans -->
<div class="container mt-4">
  <div class="d-flex justify-content-center mb-4">
    <a href="#meals" class="btn btn-link">Go to Meals</a>
    <span class="mx-3">  </span>
    <a href="#meal-plans" class="btn btn-link">Go to Meal Plans</a>
  </div>
</div>

<div class="container mt-4">
</div>
<div class="container">
  <div class="row">
    {% for recipe in recipes %}
    <div class="col-md-4 mb-4 d-flex align-items-stretch">
      <div class="card mb-0 w-100 h-100">
        {# single photo #}
          {% if recipe.photo %}
          <img src="data:image/jpeg;base64,{{ recipe.photo }}"
               class="card-img-top"
               style="height:150px;object-fit:cover;"
              alt="{{ recipe.name }} image">
          {% else %}
        <img src="{{ url_for('static', filename='images/default_recipe.jpg') }}"
             class="card-img-top"
             style="height:150px;object-fit:cover;"
             alt="Placeholder">
          {% endif %}

        <div class="card-body d-flex flex-column">
          <h5 class="card-title">{{ recipe.name }}</h5>
          <p class="card-text">Origin: {{ recipe.origin }}</p>
          <div class ="mt-auto">
            <a href="{{ url_for('views.view_recipe', recipe_id=recipe.id) }}"
               class="btn btn-primary btn-block mb-2">
              View Recipe
            </a>
            <a href="{{ url_for('views.delete_recipe', recipe_id=recipe.id) }}"
               class="btn btn-danger btn-block"
               onclick="return confirm('Are you sure you want to delete this recipe?');">
              Delete Recipe
            </a>
          </div>
        </div>
      </div>
    </div>
    {% endfor %}
    <!-- Special Add Recipe Card -->
    <div class="col-md-4 mb-4 d-flex align-items-stretch">
      <a href="{{ url_for('views.add_recipe') }}"
         class="card w-100 h-100 d-flex flex-column align-items-center justify-content-center mb-0 text-decoration-none text-dark">
        <h1>➕</h1>
        <p>Add Recipe</p>
      </a>
    </div>
  </div>
</div>


<h1 align="center" id = "meals">Meals</h1>

<!-- Links to Recipe and Meal Plans -->
<div class="container mt-4">
  <div class="d-flex justify-content-center mb-4">
    <a href="#Recipees" class="btn btn-link">Go to Recipes</a>
    <span class="mx-3">  </span>
    <a href="#meal-plans" class="btn btn-link">Go to Meal Plans</a>
  </div>
</div>

<div class="container mt-4">
</div>
<div class="container">
  <div class="row">
    {% for meal in meals %}
    <div class="col-md-4 mb-4 d-flex align-items-stretch">
      <div class="card mb-0 w-100 h-100">
        {# I removed the image part just for now, we'll come back to that later#}

        <img src="{{ url_for('static', filename='images/default_recipe.jpg') }}"
             class="card-img-top"
             style="height:150px;object-fit:cover;"
             alt="Placeholder">

        <div class="card-body d-flex flex-column">
          <h5 class="card-title">{{ meal.meal_title }}</h5>
          <div class ="mt-auto">
            <a href="{{ url_for('views.view_meal', meal_id=meal.meal_id) }}"
               class="btn btn-primary btn-block mb-2">
              View Meal
            </a>

            <form action="{{ url_for('views.delete_meal', meal_id=meal.meal_id) }}"
              method="post"
              onsubmit="return confirm('Are you sure you want to delete this meal?');"
              class="mt-auto">
              <button type="submit" class="btn btn-danger btn-block">
                Delete Meal
              </button>
            </form>
<!--            <a href="{{ url_for('views.delete_meal', meal_id=meal.meal_id) }}"-->
<!--               class="btn btn-danger btn-block"-->
<!--               onclick="return confirm('Are you sure you want to delete this meal?');">-->
<!--              Delete Meal-->
<!--            </a>-->
          </div>
        </div>
      </div>
    </div>
    {% endfor %}
    <!-- Special Add Recipe Card -->
    <div class="col-md-4 mb-4 d-flex align-items-stretch">
      <a href="{{ url_for('views.add_meal') }}"
         class="card w-100 h-100 d-flex flex-column align-items-center justify-content-center mb-0 text-decoration-none text-dark">
        <h1>➕</h1>
        <p>Add Meals</p>
      </a>
    </div>
  </div>
</div>


<h1 align="center" id = "meal-plans">Meal Plans</h1>

<!-- Links to Recipe and Meal Plans -->
<div class="container mt-4">
  <div class="d-flex justify-content-center mb-4">
    <a href="#Recipees" class="btn btn-link">Go to Recipes</a>
    <span class="mx-3">  </span>
    <a href="#meals" class="btn btn-link">Go to Meals</a>
  </div>
</div>


<div class="container mt-4">
</div>
<div class="container">
  <div class="row">

    {% for plan in meal_plans %}
    <div class="col-md-4 mb-4 d-flex align-items-stretch">
      <div class="card mb-0 w-100 h-100">
        <img src="{{ url_for('static', filename='images/default_recipe.jpg') }}"
             class="card-img-top"
             style="height:150px;object-fit:cover;"
             alt="Placeholder">

        <div class="card-body d-flex flex-column">
          <h5 class="card-title">{{ plan.title }}</h5>
          <p class="card-text text-center">
            {{ plan.start_date }} - {{ plan.end_date }}
          </p>
          <div class ="mt-auto">
            <a href="{{ url_for('views.view_meal_plan', meal_plan_id=plan.meal_plan_id) }}"
               class="btn btn-primary btn-block mb-2">
              View Plan
            </a>
            <form action = "{{ url_for('views.delete_meal_plan', meal_plan_id=plan.meal_plan_id) }}"
                method = "post"
                onsubmit="return confirm('Are you sure you want to delete this recipe?');">
              <button type = "submit" class="btn btn-danger btn-block">
                Delete Plan
              </button>
            </form>
          </div>
        </div>
      </div>
    </div>
    {% endfor %}
    <!-- Special Add Recipe Card -->
    <div class="col-md-4 mb-4 d-flex align-items-stretch">
      <a href="{{ url_for('views.add_meal_plan') }}"
         class="card w-100 h-100 d-flex flex-column align-items-center justify-content-center mb-0 text-decoration-none text-dark">
        <h1>➕</h1>
        <p>Add Meal Plan</p>
      </a>
    </div>
  </div>
</div>

<!-- Link to Recipe at top -->
<div class="container mt-4">
  <div class="d-flex justify-content-center mb-4">
    <a href="#Recipees" class="btn btn-link">Go to Top</a>
    <span class="mx-3">  </span>
  </div>
</div>
{% endblock %}