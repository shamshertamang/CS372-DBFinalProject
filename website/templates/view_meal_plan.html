{% extends "base.html" %}
{% block title %}View Meal Plan{% endblock %}

{% block profile %}
  {% if user.is_authenticated %}
    <a class="nav-item nav-link" href="{{ url_for('views.profile_page') }}">Profile</a>
  {% endif %}
{% endblock %}

{% block content %}
<div class="container mt-4">
  <h1 class="text-center">{{ plan.title }}</h1>

  <dl class="row">
    <dt class="col-sm-3">Start Date</dt>
    <dd class="col-sm-9">{{ plan.start_date }}</dd>

    <dt class="col-sm-3">End Date</dt>
    <dd class="col-sm-9">{{ plan.end_date }}</dd>

    {% if plan.goals %}
    <dt class="col-sm-3">Goals</dt>
    <dd class="col-sm-9">{{ plan.goals }}</dd>
    {% endif %}
  </dl>

  <h3 class="mt-4">Scheduled Meals</h3>
  {% if scheduled_meals %}
    <ul class="list-group mb-4">
      {% for sm in scheduled_meals|sort(attribute='scheduled_datetime') %}
        <li class="list-group-item d-flex justify-content-between align-items-center">
          <a href="{{ url_for('views.view_meal', meal_id=sm.meal_id) }}">
            {{ sm.meal_title }}
          </a>
          <small>{{ sm.scheduled_datetime | datetimeformat}}</small>
        </li>
      {% endfor %}
    </ul>
  {% else %}
    <p><em>No meals scheduled in this plan.</em></p>
  {% endif %}

  <div class="d-flex">
    <a href="{{ url_for('views.edit_meal_plan', meal_plan_id=plan.meal_plan_id) }}"
       class="btn btn-warning mr-2">Edit Plan</a>
    <a href="{{ url_for('views.home') }}#meal-plans"
       class="btn btn-secondary">Back to Meal Plans</a>
  </div>
</div>
{% endblock %}
